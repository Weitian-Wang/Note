<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Introduction</title>
        <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

/* From extension ms-toolsai.jupyter */
/* These classnames are inherited from bootstrap, but are present in most notebook renderers */

.alert {
    width: auto;
    padding: 1em;
    margin-top: 1em;
    margin-bottom: 1em;
}
.alert > *:last-child {
    margin-bottom: 0;
}
#preview > .alert:last-child {
    /* Prevent this being set to zero by the default notebook stylesheet */
    padding-bottom: 1em;
}

.alert-success {
    /* Note there is no suitable color available, so we just copy "info" */
    background-color: var(--theme-info-background);
    color: var(--theme-info-foreground);
}
.alert-info {
    background-color: var(--theme-info-background);
    color: var(--theme-info-foreground);
}
.alert-warning {
    background-color: var(--theme-warning-background);
    color: var(--theme-warning-foreground);
}
.alert-danger {
    background-color: var(--theme-error-background);
    color: var(--theme-error-foreground);
}

</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item {
    list-style-type: none;
}

.task-list-item-checkbox {
    margin-left: -20px;
    vertical-align: middle;
    pointer-events: none;
}
</style>
        
    </head>
    <body class="vscode-body vscode-light">
        <ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#grading">Grading</a></li>
<li><a href="#lab--discussion-group">Lab &amp; Discussion Group</a></li>
</ul>
</li>
<li><a href="#introduction-to-computer-security">Introduction to Computer Security</a>
<ul>
<li><a href="#definition-of-security">Definition of Security</a>
<ul>
<li><a href="#security-goals---cia">Security Goals - C.I.A</a></li>
<li><a href="#other-security-topics---aaa">Other Security Topics - A.A.A</a></li>
<li><a href="#security-principles">Security Principles</a></li>
</ul>
</li>
<li><a href="#5-important-implementations">5 Important Implementations</a>
<ul>
<li><a href="#1-confidentiality-using-symmetric-encryption">1. Confidentiality using symmetric encryption</a></li>
<li><a href="#2-confidentiality-using-asymmetric-encryption">2. Confidentiality using asymmetric encryption</a></li>
<li><a href="#3-message-authentication-using-symmetric-encryption">3. Message authentication using symmetric encryption</a></li>
<li><a href="#4-message-authentication-using-asymmetric-encryption">4. Message authentication using asymmetric encryption</a></li>
<li><a href="#5-uer-using-asymmetric-encryption---digital-certificate">5. Uer using asymmetric encryption - digital certificate</a></li>
</ul>
</li>
<li><a href="#authentication-technologies">Authentication Technologies</a>
<ul>
<li><a href="#password">Password</a>
<ul>
<li><a href="#storage-of-passwords">Storage of Passwords</a></li>
<li><a href="#password-salt">Password Salt</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#direct-attack">Direct Attack</a>
<ul>
<li><a href="#environmental-attacke">Environmental Attacke</a></li>
<li><a href="#eavesdropping">Eavesdropping</a></li>
<li><a href="#wiretapping">Wiretapping</a></li>
<li><a href="#acoustic-emissions">Acoustic Emissions</a></li>
<li><a href="#hardware-keylogger">Hardware Keylogger</a></li>
<li><a href="#tempest">TEMPEST</a></li>
<li><a href="#emanation-blockage">Emanation Blockage</a></li>
<li><a href="#atms">ATMs</a>
<ul>
<li><a href="#magnetic-stripe-card">Magnetic Stripe Card</a></li>
<li><a href="#chipped-card">Chipped Card</a></li>
</ul>
</li>
<li><a href="#sim-card">SIM Card</a></li>
<li><a href="#biometrics">Biometrics</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#operating-system--file-system-security">Operating System &amp; File System Security</a>
<ul>
<li><a href="#operating-system">Operating System</a></li>
<li><a href="#file-system">File System</a>
<ul>
<li><a href="#file-permission">File Permission</a></li>
<li><a href="#bitlocker-encryption">Bitlocker Encryption</a>
<ul>
<li><a href="#basics">Basics</a></li>
<li><a href="#decryption">Decryption</a></li>
<li><a href="#update-key">Update Key</a></li>
</ul>
</li>
<li><a href="#encrypting-file-system">Encrypting File System</a>
<ul>
<li><a href="#basics-1">Basics</a></li>
<li><a href="#encryption">Encryption</a></li>
<li><a href="#decryption-1">Decryption</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#process">Process</a></li>
<li><a href="#memory">Memory</a>
<ul>
<li><a href="#memory-segments">Memory Segments</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#software--program-security">Software &amp; Program Security</a>
<ul>
<li><a href="#buffer-overflow">Buffer Overflow</a>
<ul>
<li><a href="#buffer">Buffer</a></li>
<li><a href="#overflow-attack">Overflow Attack</a></li>
<li><a href="#countermeasures">Countermeasures</a>
<ul>
<li><a href="#aslr---address-space-layout-randomization">ASLR - Address Space Layout Randomization</a></li>
<li><a href="#dep---data-execution-prevention">DEP - Data Execution Prevention</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#heart-bleed-buffer-overread---memory-leak">Heart Bleed (Buffer Overread) - Memory Leak</a></li>
<li><a href="#command-injection">Command Injection</a>
<ul>
<li><a href="#command-injection-vs-code-injection">Command Injection vs Code Injection</a></li>
</ul>
</li>
<li><a href="#integer-overflow">Integer Overflow</a></li>
<li><a href="#file-access-race-condition---toctou">File Access Race Condition - TOCTOU</a></li>
</ul>
</li>
<li><a href="#malware">Malware</a>
<ul>
<li><a href="#catagories-of-malware">Catagories of Malware</a>
<ul>
<li><a href="#according-to-propagation">According to Propagation</a></li>
<li><a href="#according-to-concealment">According to Concealment</a></li>
</ul>
</li>
<li><a href="#insider-attacks">Insider Attacks</a>
<ul>
<li><a href="#backdoors">Backdoors</a></li>
<li><a href="#logic-bomb">Logic Bomb</a></li>
<li><a href="#defenses">Defenses</a></li>
</ul>
</li>
<li><a href="#virus">Virus</a>
<ul>
<li><a href="#phases">Phases</a></li>
<li><a href="#countermeasures-1">Countermeasures</a>
<ul>
<li><a href="#signature">Signature</a></li>
<li><a href="#heuristic">Heuristic</a>
<ul>
<li><a href="#code-analysis">Code Analysis</a></li>
<li><a href="#execution-emulation">Execution Emulation</a></li>
</ul>
</li>
<li><a href="#static-analysis--dynamic-analysis">Static Analysis &amp; Dynamic Analysis</a></li>
</ul>
</li>
<li><a href="#concealment">Concealment</a>
<ul>
<li><a href="#encrypted-virus">Encrypted Virus</a>
<ul>
<li><a href="#characteristics">Characteristics</a></li>
<li><a href="#detection">Detection</a></li>
</ul>
</li>
<li><a href="#polymorphic-virus">Polymorphic Virus</a>
<ul>
<li><a href="#characteristics-1">Characteristics</a></li>
<li><a href="#detection-1">Detection</a></li>
</ul>
</li>
<li><a href="#metamorphic-virus">Metamorphic Virus</a>
<ul>
<li><a href="#characteristics-2">Characteristics</a></li>
<li><a href="#detection-2">Detection</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#worm">Worm</a></li>
</ul>
</li>
<li><a href="#network-security">Network Security</a>
<ul>
<li><a href="#network-basics">Network Basics</a>
<ul>
<li><a href="#5-layer-network-model">5 Layer Network Model</a>
<ul>
<li><a href="#physical-layer">Physical Layer</a></li>
<li><a href="#data-link-layer">Data Link Layer</a></li>
<li><a href="#network-layer">Network Layer</a></li>
<li><a href="#transport-layer">Transport Layer</a></li>
<li><a href="#application-layer">Application Layer</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#solve-ipv4-address-shortage---nat">Solve IPv4 Address Shortage - NAT</a></li>
<li><a href="#network-attacks">Network Attacks</a>
<ul>
<li><a href="#arp-spoofing--poisoning">ARP Spoofing &amp; Poisoning</a>
<ul>
<li><a href="#arp-basics">ARP Basics</a></li>
<li><a href="#arp-vulnerability">ARP Vulnerability</a></li>
</ul>
</li>
<li><a href="#icmp-attack">ICMP Attack</a>
<ul>
<li><a href="#icmp-basics">ICMP Basics</a></li>
<li><a href="#icmp-vulnerability">ICMP Vulnerability</a>
<ul>
<li><a href="#ping-of-death">Ping of Death</a></li>
<li><a href="#smurf-attack">Smurf Attack</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ip-vulnerabilies">IP Vulnerabilies</a></li>
<li><a href="#denial-of-service-attack">Denial of Service Attack</a></li>
<li><a href="#syn-flood">SYN Flood</a></li>
<li><a href="#session-hijacking">Session Hijacking</a></li>
<li><a href="#ip-spoofing">IP Spoofing</a></li>
<li><a href="#packet-sniffer">Packet Sniffer</a></li>
<li><a href="#dns-attacks">DNS Attacks</a>
<ul>
<li><a href="#dns-basics">DNS Basics</a></li>
<li><a href="#dns-posioning">DNS Posioning</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#transport-layer-security--secure-socket-layer-tlsssl">Transport Layer Security / Secure Socket Layer (TLS/SSL)</a></li>
<li><a href="#virtual-private-network">Virtual Private Network</a>
<ul>
<li><a href="#ip-tunneling">IP Tunneling</a>
<ul>
<li><a href="#ipsec-tunneling">IPSec Tunneling</a></li>
<li><a href="#tlsssl-tunneling">TLS/SSL Tunneling</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#symmetric-encryption">Symmetric Encryption</a>
<ul>
<li><a href="#terminologies">Terminologies</a></li>
<li><a href="#classic">Classic</a>
<ul>
<li><a href="#substitution">Substitution</a></li>
<li><a href="#permutation">Permutation</a></li>
<li><a href="#vulnerability">Vulnerability</a></li>
</ul>
</li>
<li><a href="#mordern">Mordern</a>
<ul>
<li><a href="#advanced-encryption-standard">Advanced Encryption Standard</a>
<ul>
<li><a href="#substitution-permutation-network">Substitution-Permutation Network</a></li>
<li><a href="#specifications">Specifications</a></li>
<li><a href="#aes-structure">AES Structure</a></li>
<li><a href="#1-substitute-bytes">1. Substitute Bytes</a></li>
<li><a href="#2-shift-rows">2. Shift Rows</a></li>
<li><a href="#3-mix-columns">3. Mix Columns</a>
<ul>
<li><a href="#matrix-multiplication---multiply">Matrix Multiplication - Multiply</a></li>
<li><a href="#matrix-multiplication---add">Matrix Multiplication - Add</a></li>
</ul>
</li>
<li><a href="#4-xor-round-key">4. XOR Round Key</a></li>
</ul>
</li>
<li><a href="#mathematics-of-ase">Mathematics of ASE</a>
<ul>
<li><a href="#xor-inverse-property">XOR Inverse Property</a></li>
<li><a href="#set-and-field">Set and Field</a></li>
<li><a href="#identity">Identity</a>
<ul>
<li><a href="#additive-identity">Additive Identity</a></li>
<li><a href="#multiplicative-identity">Multiplicative Identity</a></li>
</ul>
</li>
<li><a href="#inverse">Inverse</a>
<ul>
<li><a href="#additive-inverse">Additive Inverse</a></li>
<li><a href="#multiplicative-inverse">Multiplicative Inverse</a></li>
</ul>
</li>
<li><a href="#modulo-arithmetic">Modulo Arithmetic</a></li>
<li><a href="#finite-field">Finite Field</a></li>
<li><a href="#galois-field">Galois Field</a>
<ul>
<li><a href="#primitive-galois-field">Primitive Galois Field</a></li>
<li><a href="#extension-galois-field">Extension Galois Field</a>
<ul>
<li><a href="#special-galois-field-gf2n">Special Galois Field <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>f</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">gf(2^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></a></li>
<li><a href="#addition">Addition</a></li>
<li><a href="#modulo-reduction">Modulo Reduction</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#asymmetric-encryption">Asymmetric Encryption</a>
<ul>
<li><a href="#applications">Applications</a></li>
<li><a href="#rsa">RSA</a>
<ul>
<li><a href="#key-generation">Key Generation</a></li>
<li><a href="#rsa-encryption-and-decryption">RSA Encryption and Decryption</a>
<ul>
<li><a href="#encryption-with-public-key">Encryption with Public Key</a></li>
<li><a href="#decryption-with-private-key">Decryption with Private Key</a></li>
</ul>
</li>
<li><a href="#mathematics-for-rsa">Mathematics for RSA</a>
<ul>
<li><a href="#division">Division</a></li>
<li><a href="#euclids-algorithm---gcd">Euclid's Algorithm - GCD</a></li>
<li><a href="#bizouts-identity">Bizout's Identity</a></li>
<li><a href="#application-of-euclid-and-bizout-in-rsa">Application of Euclid and Bizout in RSA</a></li>
<li><a href="#euler-totient-function">Euler Totient Function</a></li>
<li><a href="#fermats-little-theorem">Fermat's Little Theorem</a></li>
<li><a href="#eulers-theorem">Euler's Theorem</a></li>
<li><a href="#implement-theorem-in-rsa">Implement Theorem in RSA</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#final-review">Final Review</a>
<ul>
<li><a href="#ice4-rsa-part">ICE4 RSA part:</a></li>
<li><a href="#ice3-aes-part">ICE3 AES part:</a></li>
<li><a href="#ice2-network-security">ICE2 Network Security</a></li>
<li><a href="#ice1-symmetric--asymmetric-cryptosystem">ICE1 Symmetric &amp; Asymmetric Cryptosystem</a></li>
</ul>
</li>
</ul>
<h1 id="introduction">Introduction</h1>
<h2 id="grading">Grading</h2>
<p>10 Weeks, 4 Lab, 4 HW</p>
<ol>
<li>30% Homework</li>
<li>30% Lab</li>
<li>30% Final Exam</li>
<li>10% Class - Class study case will appear in final!</li>
</ol>
<h2 id="lab--discussion-group">Lab &amp; Discussion Group</h2>
<p>Groups 75, Ismat Jarin, 1st Year PhD student (Security), <a href="mailto:ijarin@uci.edu">ijarin@uci.edu</a></p>
<h1 id="introduction-to-computer-security">Introduction to Computer Security</h1>
<h2 id="definition-of-security">Definition of Security</h2>
<blockquote>
<p>Memorize the case study instead of the plain definition of concept.</p>
</blockquote>
<p>Security of system, application, or protocol is <strong>related</strong> to</p>
<ul>
<li>A set of desired properties - Security Goals</li>
<li>An adversary with specific capabilities - Threads and Attacks</li>
</ul>
<h3 id="security-goals---cia">Security Goals - C.I.A</h3>
<ul>
<li>Confidentiality - avoidance of unauthorized disclosure of info
<ol>
<li>
<p>Encryption</p>
</li>
<li>
<p>Access Control</p>
</li>
<li>
<p>Authentication<br>
Determin the identity of someone.</p>
</li>
<li>
<p>Authorization<br>
Determin the user's access to resources.</p>
<blockquote>
<p>Study case: Student, professor, TA see different pages after login canvas with UCI NetID.</p>
</blockquote>
</li>
<li>
<p>Physical Security</p>
</li>
</ol>
</li>
<li>Integrity - avoidance of unauthorized info alteration
<ol>
<li>Backups</li>
<li>Check Sum</li>
<li>Data Correction Codes</li>
</ol>
</li>
<li>Availability - info is accessable to authorized personal
<ol>
<li>Physical Protection</li>
<li>Computational Redundancies</li>
</ol>
</li>
</ul>
<blockquote>
<p>Study case:<br>
Confidentiality: Russia gets data from Ukraine military.
Integrity: Change nuclear power plant sensors' data sent to control center.<br>
Availability: Viasat terminals in Europe rendered inoperable as modems were attacked.</p>
</blockquote>
<h3 id="other-security-topics---aaa">Other Security Topics - A.A.A</h3>
<ul>
<li>Assurance</li>
<li>Authenticity</li>
<li>Anonymity</li>
</ul>
<h3 id="security-principles">Security Principles</h3>
<p>Ideas that make a system safer.</p>
<h2 id="5-important-implementations">5 Important Implementations</h2>
<blockquote>
<p>Notations:<br>
M - Message - Plain message<br>
C - Cipher - Encrypted message<br>
E[] - Encrypt function<br>
D[] - Decrypt function<br>
H - Hash value after Hash[] function<br>
P - Public Key<br>
S - Secret Key (symmetric or asymmetric)<br>
i.e. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><msub><mi>E</mi><msub><mi>P</mi><mi>A</mi></msub></msub><mo stretchy="false">[</mo><mi>M</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">C = E_{P_A}[M]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">]</span></span></span></span> means <strong>E</strong>ncrypt <strong>M</strong>essage with user <strong>A</strong>'s <strong>P</strong>ublic key to get <strong>C</strong>ipher.<br>
When denoting secret key in symmetric cryptography system, use subsript of both side <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{AB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
</blockquote>
<h3 id="1-confidentiality-using-symmetric-encryption">1. Confidentiality using symmetric encryption</h3>
<p>Sender A and Receiver B shares secret key <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{AB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. As long as secret key is not compromised, the confidentiality of communication is ensured.<br>
Sender A Encrypts message M with secret key <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><msub><mi>E</mi><msub><mi>S</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></msub><mo stretchy="false">[</mo><mi>M</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">C=E_{S_{AB}}[M]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">]</span></span></span></span><br>
Send Cipher C to Reciver B<br>
Receiver B Decrypts cipher with secret key <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><msub><mi>D</mi><msub><mi>S</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></msub><mo stretchy="false">[</mo><mi>C</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">M=D_{S_{AB}}[C]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">]</span></span></span></span></p>
<h3 id="2-confidentiality-using-asymmetric-encryption">2. Confidentiality using asymmetric encryption</h3>
<p>Sender A has Public Key <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>u</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">Pu_{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and Private Key <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>r</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">Pr_{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.<br>
Reciver B has Public Key <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>u</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">Pu_{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and Private Key <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>r</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">Pr_{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.<br>
Public key is shared with all communication parties.<br>
Sender A Encrypts message M with B's Public Key <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><msub><mi>E</mi><mrow><mi>P</mi><msub><mi>u</mi><mi>B</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>M</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">C=E_{Pu_{B}}[M]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">]</span></span></span></span><br>
Send Cipher C to Reciver B<br>
Reciver B Decrypts cipher with its private key <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><msub><mi>D</mi><mrow><mi>P</mi><msub><mi>r</mi><mi>B</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>C</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">M=D_{Pr_{B}}[C]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0278em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">]</span></span></span></span></p>
<h3 id="3-message-authentication-using-symmetric-encryption">3. Message authentication using symmetric encryption</h3>
<blockquote>
<p>Authentication ensures message integrity and authenticity.<br>
Unless secret key is leaked, the man in the middle won't be able to change both orginal message and hash.</p>
</blockquote>
<p>Sender A generate Hash of message <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><mi>H</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>M</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">H=Hash[M]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">]</span></span></span></span><br>
Sender A encrypt the hash with secret key <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><msub><mi>E</mi><msub><mi>S</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></msub><mo stretchy="false">[</mo><mi>H</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>M</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>=</mo><msub><mi>E</mi><msub><mi>S</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></msub><mo stretchy="false">[</mo><mi>H</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">C=E_{S_{AB}}[Hash[M]]=E_{S_{AB}}[H]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">]]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mclose">]</span></span></span></span><br>
Send original message M with encrypted hash <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">M||C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord">∣∣</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><br>
Receiver B calculates own hash of message <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>H</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>H</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>M</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">H&#x27;=Hash[M]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">]</span></span></span></span><br>
Receiver B decrypts cipher with secret key to get sender's message hash <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>D</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><msub><mi>D</mi><msub><mi>S</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></msub><mo stretchy="false">[</mo><mi>C</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">D&#x27;=D_{S_{AB}}[C]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">]</span></span></span></span><br>
Compare <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>H</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">H&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>D</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">D&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="4-message-authentication-using-asymmetric-encryption">4. Message authentication using asymmetric encryption</h3>
<p>Sender A generate Hash of message <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><mi>H</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>M</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">H=Hash[M]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">]</span></span></span></span><br>
Sender A encrypt the hash with <strong>its private key</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><msub><mi>E</mi><mrow><mi>P</mi><msub><mi>r</mi><mi>A</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>H</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>M</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo>=</mo><msub><mi>E</mi><mrow><mi>P</mi><msub><mi>r</mi><mi>A</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>H</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">C=E_{Pr_{A}}[Hash[M]]=E_{Pr_{A}}[H]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0278em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">]]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0278em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mclose">]</span></span></span></span><br>
Send original message M with encrypted hash <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">M||C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord">∣∣</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><br>
Receiver B calculates own hash of message <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>H</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>H</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>M</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">H&#x27;=Hash[M]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">]</span></span></span></span><br>
Receiver B decrypts cipher with sender's public key to get sender's message hash <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>D</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><msub><mi>D</mi><mrow><mi>P</mi><msub><mi>u</mi><mi>A</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>C</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">D&#x27;=D_{Pu_{A}}[C]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">]</span></span></span></span><br>
Compare <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>H</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">H&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>D</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">D&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></p>
<blockquote>
<p>Public key is accessible to everyone encluding attacker. To ensure the man in the middle can't generate the same authentication message, we use private key to encrypt the hash.</p>
</blockquote>
<h3 id="5-uer-using-asymmetric-encryption---digital-certificate">5. Uer using asymmetric encryption - digital certificate</h3>
<p>CA - Certificate Agency is a entrusted third party, has <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>u</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Pu_{CA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>r</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Pr_{CA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
The digitial certificate of A:<br>
The <strong>hash</strong> of A's <strong>public key</strong> signed by CA's <strong>private key</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>P</mi><msub><mi>r</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub></mrow></msub><mo stretchy="false">[</mo><mi>H</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>P</mi><msub><mi>u</mi><mi>A</mi></msub><mo stretchy="false">]</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">E_{Pr_{CA}}[Hash[Pu_{A}]]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0278em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]]</span></span></span></span><br>
For communiction party B, when it acquires A's public key and want to certify the authenticity of that, B decrypts the certificate with CA's public key and get the hash of authentic <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>u</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">Pu_{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. Compare the hash to certify A's public key. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><msub><mi>D</mi><mrow><mi>P</mi><msub><mi>u</mi><mrow><mi>C</mi><mi>A</mi></mrow></msub></mrow></msub><mo stretchy="false">[</mo><mi>C</mi><mi>e</mi><mi>r</mi><msub><mi>t</mi><mi>A</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">H=D_{Pu_{CA}}[Cert_A]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></p>
<blockquote>
<p>If CA's private key is compromised, attacker can sign certificate for malicious parties' public keys.</p>
</blockquote>
<h2 id="authentication-technologies">Authentication Technologies</h2>
<p>Authentication is the determination of identity, which is base on:</p>
<ol>
<li>something the person knows (password)</li>
<li>something the person has (keycard, physical storage of secret keys)</li>
<li>something the person is (biological fingerprints or iris)</li>
</ol>
<h3 id="password">Password</h3>
<h4 id="storage-of-passwords">Storage of Passwords</h4>
<p>Store password hash instead of original plaintext password. This prevents the acquisition of password even if attacker gets hold of database.</p>
<h4 id="password-salt">Password Salt</h4>
<p>To prevent dictionary attack on the password database, password salt can be added when hashing the password.<br>
A cryptographic salt is made up of <strong>random bits</strong> added to each password instance <strong>before</strong> its hashing. Salts create unique passwords even in the instance of two users choosing the same passwords. Salts help us mitigate hash table (dictionary) attacks by forcing attackers to re-compute them using the salts for each user.<br>
To mitigate the damage that a hash table or a dictionary attack could do, we salt the passwords. Salt is a value generated by a cryptographically secure function that is added to the input of hash functions to create unique hashes for every input, regardless of the input not being unique. A salt makes a hash function look non-deterministic, which is good as we don't want to reveal duplicate passwords through our hashing.<br>
Let’s say that we have the password farm1990M0O and the salt f1nd1ngn3m0. We can salt that password by either appending or prepending the salt to it. For example, farm1990M0Of1nd1ngn3m0 or f1nd1ngn3m0farm1990M0O are valid salted passwords. Once the salt is added, we can then hash it.</p>
<h2 id="direct-attack">Direct Attack</h2>
<h3 id="environmental-attacke">Environmental Attacke</h3>
<ol>
<li>Electricity</li>
<li>Temperture</li>
<li>Limited Conductance - Short circuit by flood</li>
</ol>
<h3 id="eavesdropping">Eavesdropping</h3>
<h3 id="wiretapping">Wiretapping</h3>
<h3 id="acoustic-emissions">Acoustic Emissions</h3>
<h3 id="hardware-keylogger">Hardware Keylogger</h3>
<h3 id="tempest">TEMPEST</h3>
<p>Levels:</p>
<ol>
<li>Direct contact</li>
<li>20 meters</li>
<li>100 meters</li>
</ol>
<h3 id="emanation-blockage">Emanation Blockage</h3>
<p>Block the visible light, acoustic and electromagnetic emanation.</p>
<h3 id="atms">ATMs</h3>
<h4 id="magnetic-stripe-card">Magnetic Stripe Card</h4>
<p>Skimmer can read card data and make replica.</p>
<h4 id="chipped-card">Chipped Card</h4>
<p>Smart cards incorporate a circuit, allowing the reading and writing of the card data. This enables secure authentication for the cards.</p>
<h3 id="sim-card">SIM Card</h3>
<p>Subscriber Identity Module Card.</p>
<h3 id="biometrics">Biometrics</h3>
<ul>
<li>Fingerprints</li>
<li>Retinal/iris scans</li>
<li>DNA</li>
<li>Voice recognition</li>
<li>Face recognition</li>
<li>Gait recognition</li>
</ul>
<h1 id="operating-system--file-system-security">Operating System &amp; File System Security</h1>
<p>Every component can be attacked. Same for the network. Study the components first then possible vulnerabilities.</p>
<h2 id="operating-system">Operating System</h2>
<p>The security of operating system should be built in</p>
<ol>
<li>The construction of OS</li>
<li>The installation of OS</li>
<li>Secure booting process</li>
<li>Security of additional device</li>
<li>Keep OS up to date with all known security problem patched</li>
</ol>
<h2 id="file-system">File System</h2>
<p>File system is the abstraction of how external storage of computer is managed.</p>
<h3 id="file-permission">File Permission</h3>
<ul>
<li>Read: This permission give you the authority to open and read a file. Read permission on a directory gives you the ability to list its content.</li>
<li>Write: The write permission gives you the authority to modify the contents of a file. The write permission on a directory gives you the authority to add, remove and rename files stored in the directory. Consider a scenario where you have to write permission on a file but do not have write permission on the directory where the file is stored. You will be able to modify the file contents. But you will not be able to rename, move or remove the file from the directory.</li>
<li>Execute: In Windows, an executable program usually has an extension “.exe” that you can quickly run. In Unix/Linux, you cannot run a program unless the execute permission is set. If the execute permission is not set, you might still be able to see/modify the program code(provided read &amp; write permissions are set), but not run it.</li>
</ul>
<p>r = read permission<br>
w = write permission<br>
x = execute permission<br>
– = no permission<br>
User Group Others<br>
rwxr-xr-x</p>
<pre><code class="language-sh"><span class="hljs-built_in">chmod</span> 755 filename
<span class="hljs-built_in">chmod</span> u+r filename
<span class="hljs-built_in">chmod</span> u=rwx filename
</code></pre>
<h3 id="bitlocker-encryption">Bitlocker Encryption</h3>
<h4 id="basics">Basics</h4>
<pre><code>                                   ┌────────┐
┌─────┐    ┌─────┐    ┌──────┐     │        │
│ SRK ├───►│ VEK ├───►│ FVEK ├────►│  Disk  │
└─────┘    └─────┘    └──────┘     │        │
                                   └────────┘
</code></pre>
<blockquote>
<p>SRK: Storage Root Key stored in Trusted Platform Module (TPM)<br>
VEK: Volume Encryption Key, encrypted by SRK and stored in disk<br>
FVEK: Full Volume Encryption Key, encrypted by VEK and stored in disk<br>
Disk: Encrypt/decrypt disk data with FVEK, computaionally heavy task</p>
</blockquote>
<h4 id="decryption">Decryption</h4>
<ol>
<li>Get encrypted VEK from disk, decrypt with SRK</li>
<li>Get encrypted FVEK from disk, decrypt with VEK</li>
<li>Get encrypted file/volume from disk, decrypt with FVEK</li>
</ol>
<h4 id="update-key">Update Key</h4>
<p>If only one key is used to encrypt data, the update of key requires:</p>
<ol>
<li>The decryption of entire hard disk with old key</li>
<li>Generate new key</li>
<li>Encrypt entire hard disk with new key<br>
The decryption and encryption of the entire disk is computationally expensive</li>
</ol>
<p>If we use three level volume encryption key, we only need to update middle key:</p>
<ol>
<li>Get encrypted VEK from disk, decryt with SRK</li>
<li>Get encrypted FVEK from disk, decrypt with VEK</li>
<li>Generate new VEK</li>
<li>Encrypt FVEK with VEK, store new encryption in disk</li>
<li>Encrypt VEK with SRK, store new encryption in disk</li>
</ol>
<h3 id="encrypting-file-system">Encrypting File System</h3>
<h4 id="basics">Basics</h4>
<p>User have public key and private key of RSA asymmetric cryptosystem. User can also generate symmetric File Encryption Key (FEK).</p>
<h4 id="encryption">Encryption</h4>
<ol>
<li>Dynamically generate File Encryption Key for each encryption.</li>
<li>Encrypt file with FEK.</li>
<li>Encrypt FEK with user public key.</li>
<li>Put encrypted FEK in the header of encrypted file.</li>
</ol>
<h4 id="decryption">Decryption</h4>
<ol>
<li>Extract encrypted FEK from encrypted file header.</li>
<li>Decrypt FEK with user private key.</li>
<li>Decrypt file with FEK.</li>
</ol>
<h2 id="process">Process</h2>
<p>Instance of executing program. Instrucions must be load into RAM to execute.</p>
<h2 id="memory">Memory</h2>
<p>DRAM is the address space of compuet. Memory contains both data and instruction for the Von Neumann architecture.</p>
<blockquote>
<p>Review Lab1 stack overflow for this section.</p>
</blockquote>
<h3 id="memory-segments">Memory Segments</h3>
<p>The misuse of segments can cause security concerns.</p>
<ol>
<li>Text</li>
<li>Data</li>
<li>BSS</li>
<li>Heap</li>
<li>Stack</li>
</ol>
<h1 id="software--program-security">Software &amp; Program Security</h1>
<h2 id="buffer-overflow">Buffer Overflow</h2>
<h3 id="buffer">Buffer</h3>
<p>Buffer is the portion of memory alloced to arrays. Buffer is in the stack segment of memory.</p>
<h3 id="overflow-attack">Overflow Attack</h3>
<p>Buffer overflow occurs when copying data into memory without length check. The progrm will write data into memory exceeding the array bound, causing unauthorized writing of memory.</p>
<blockquote>
<p>Review Lab1</p>
</blockquote>
<h3 id="countermeasures">Countermeasures</h3>
<h4 id="aslr---address-space-layout-randomization">ASLR - Address Space Layout Randomization</h4>
<p>ASLR prevents the attacker from reliably jumping to malicious function in memory. This countermeasure randomizes the address space position of the process, including stack, heap and libraries. ASLR became a hurdle for attacks who try to guess and hardwire the target injection address with the overflow attack.</p>
<h4 id="dep---data-execution-prevention">DEP - Data Execution Prevention</h4>
<p>Data Execution Prevention marks certain vulnerable parts as non-executable, to prevent the execution of malicious instructions.</p>
<h2 id="heart-bleed-buffer-overread---memory-leak">Heart Bleed (Buffer Overread) - Memory Leak</h2>
<p>Vitim software OpenSSL use non-sanitized user input length parameter. The length parameter is then passed to memcpy() without length check. The victim software will allocate a 64KB buffer, then copy more bytes than is necessary from memory to the buffer and send the buffer back. Therefore the memory contents are leaked to attacker 64KB at a time.</p>
<h2 id="command-injection">Command Injection</h2>
<p>Command Injection is a type of cyber attack that seeks to execute shell commands via a vulnerable application. This type of attack is possible when an application passes user supplied data to the system shell. (i.e. cookies, forms, HTTP Headers)</p>
<h3 id="command-injection-vs-code-injection">Command Injection vs Code Injection</h3>
<p>Command injection passes untrusted user input to the system shell.<br>
Code injection inject malicious code into vulnerable program. i.e SQL Injection.</p>
<h2 id="integer-overflow">Integer Overflow</h2>
<p>Also known as wraparound errors. If integer exceeds the type maximum of minimum, attacker can exploit this to get around condition check of that integer.</p>
<h2 id="file-access-race-condition---toctou">File Access Race Condition - TOCTOU</h2>
<p>Time-of-check, time-of-use.<br>
TOCTOU occurs when two or more processes concurrently access a shared file system.<br>
The victim program performing multiple operations (accesses and opens in the following exmple) on a single file will eventually create a race condition between two operations.<br>
The race condition exploitable because an attacker can alter the file between the two operations and replace the file completely to gain elevated privilege.<br>
Victim</p>
<pre><code class="language-c"><span class="hljs-comment">// check if user running this program have access to file</span>
<span class="hljs-comment">// access() open() operate on filename instead of handle</span>
<span class="hljs-keyword">if</span> (access(<span class="hljs-string">&quot;file&quot;</span>, W_OK) != <span class="hljs-number">0</span>) {
    <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);
}
<span class="hljs-comment">// attacker link &quot;file&quot; to a different file /etc/passwd</span>
fd = open(<span class="hljs-string">&quot;file&quot;</span>, O_WRONLY);
<span class="hljs-comment">// Actually writing over /etc/passwd</span>
write(fd, buffer, <span class="hljs-keyword">sizeof</span>(buffer));
<span class="hljs-comment">// run this block over and over again will incur rece condition</span>
</code></pre>
<p>Attacker</p>
<pre><code class="language-c"><span class="hljs-comment">// After the access check</span>
symlink(<span class="hljs-string">&quot;/etc/passwd&quot;</span>, <span class="hljs-string">&quot;file&quot;</span>);
<span class="hljs-comment">// Before the open, &quot;file&quot; points to the password database</span>
</code></pre>
<h1 id="malware">Malware</h1>
<p>Maliciou software.</p>
<h2 id="catagories-of-malware">Catagories of Malware</h2>
<p>Malwares can be classified into several catagories based on different characteristics.</p>
<h3 id="according-to-propagation">According to Propagation</h3>
<ul>
<li>Virus: human assisted propagation, triggered by host action</li>
<li>Worm: automatic propagation, self replicate</li>
</ul>
<h3 id="according-to-concealment">According to Concealment</h3>
<ul>
<li>Rootkit: modifies OS to hide its existence</li>
<li>Trojan: provides desirable functionality but hides malicious operation</li>
</ul>
<h2 id="insider-attacks">Insider Attacks</h2>
<p>Security breach caused by someone who is part of the organization that builds the asset that should be protected.</p>
<h3 id="backdoors">Backdoors</h3>
<p>Hidden feature or command that allow user to perform unallowed actions.</p>
<h3 id="logic-bomb">Logic Bomb</h3>
<p>A program performs malicious action when certain logic conditions occur.</p>
<h3 id="defenses">Defenses</h3>
<ol>
<li>Avoid single point of failure</li>
<li>Code walk-throughs</li>
<li>Limit authority and permission</li>
<li>etc.</li>
</ol>
<h2 id="virus">Virus</h2>
<p>virus is computer code that replicate itself, by modifying other files or programs to insert code that can further replicate the virus itself. The replication of virus requires use assistance (click link, insert USB drive).</p>
<h3 id="phases">Phases</h3>
<ol>
<li>Dormant Phase</li>
<li>Propagation Phase</li>
<li>Triggering Phase</li>
<li>Action Phase</li>
</ol>
<h3 id="countermeasures">Countermeasures</h3>
<p>Analyse known virus, then search for similar signatures and heuristics of code in user's computer. If the code is re-encrypted the antivirus tool will fail to recognize the virus.</p>
<h4 id="signature">Signature</h4>
<p>A signature is a virus fingerprint, e.g a sequence of instruction specific for each virus. Use pattern matching techniques to search for signatures in a known virus signature database.</p>
<h4 id="heuristic">Heuristic</h4>
<p>Heuristic anaylsis is useful againt new malware.</p>
<h5 id="code-analysis">Code Analysis</h5>
<p>Check if program have suspecious instructions like delete system files.</p>
<h5 id="execution-emulation">Execution Emulation</h5>
<p>Run code in isolated emulation environment and monitor harmful actions.</p>
<h4 id="static-analysis--dynamic-analysis">Static Analysis &amp; Dynamic Analysis</h4>
<p>Static analysis checks the code without executing it.<br>
Dynamic analysis evaluates the execution of codes, usually in a sandbox.</p>
<h3 id="concealment">Concealment</h3>
<h4 id="encrypted-virus">Encrypted Virus</h4>
<h5 id="characteristics">Characteristics</h5>
<p>The virus body is encrypted, which may get around detection. The virus package comes with a decryption engine.</p>
<h5 id="detection">Detection</h5>
<p>Detection of encrypted virus looks for decryption engine.</p>
<h4 id="polymorphic-virus">Polymorphic Virus</h4>
<h5 id="characteristics">Characteristics</h5>
<p>Based on encrypted virus. The mutation engine creates a new decryption routine to make it appear different each time.</p>
<h5 id="detection">Detection</h5>
<p>Although name, size and location might change for each virus copy, the function and goal of the virus ramains the same. Detection using CPU emulator.</p>
<h4 id="metamorphic-virus">Metamorphic Virus</h4>
<h5 id="characteristics">Characteristics</h5>
<p>Metamorphic virus rewrites itself at each iteration. The virus body become different, using code permutation and instruction replacement.</p>
<h5 id="detection">Detection</h5>
<p>Challenging to detect.</p>
<h2 id="worm">Worm</h2>
<h1 id="network-security">Network Security</h1>
<h2 id="network-basics">Network Basics</h2>
<h3 id="5-layer-network-model">5 Layer Network Model</h3>
<h4 id="physical-layer">Physical Layer</h4>
<p>Zeros and ones.<br>
Transmission of bits. Protocol physical property agreements about wires and interfaces.</p>
<h4 id="data-link-layer">Data Link Layer</h4>
<p>Frames send according to MAC addresses.<br>
Delivers data frame within a local network. Protocols: Ethernet, Wireless Ethernet.</p>
<h4 id="network-layer">Network Layer</h4>
<p>Packets send according to IP addresses.<br>
Deliver packets between hosts, work cross different networks. Protocol: IPv4, Address Resolution Protocol, Internet Control Message Protocol, Dynamic Host Configuration Protocol.<br>
ARP: Asking for or telling others the mapping between MAC and IP
ping command: ICMP</p>
<h4 id="transport-layer">Transport Layer</h4>
<p>Port number on top of IP addresses.<br>
Delivers data from a process one host to a process on another host. Host assign port number to process. Protocol: TCP, UDP.</p>
<h4 id="application-layer">Application Layer</h4>
<p>Protocol: Domain Name System, HTTP, HTTPS, SSH, FTP</p>
<h2 id="solve-ipv4-address-shortage---nat">Solve IPv4 Address Shortage - NAT</h2>
<p>NAT stands for Netword Address Translation. NAT translate one IP address to another. With port translation, NAT allows multiple host to use a single public IP address.</p>
<h2 id="network-attacks">Network Attacks</h2>
<h3 id="arp-spoofing--poisoning">ARP Spoofing &amp; Poisoning</h3>
<h4 id="arp-basics">ARP Basics</h4>
<p>ARP - Address Resolution Protocol is the protocol that connects datalink layer with network layer, as it translates between MAC address and IP address.<br>
ARP broadcast requests asking for MAC address of a given IP address.
who has <a href="http://xxx.xxx.xxx.xxx">xxx.xxx.xxx.xxx</a> tell <a href="http://xxx.xxx.xxx.xxx">xxx.xxx.xxx.xxx</a><br>
The machine knows the MAC of target IP receives the request and broadcast a response.<br>
<a href="http://xxx.xxx.xxx.xxx">xxx.xxx.xxx.xxx</a> is MAX_ADDRESS</p>
<h4 id="arp-vulnerability">ARP Vulnerability</h4>
<p>As ARP requests are neither tracked nor authenticated, a rogue machine can spoof other machines and respond ARP requests with faulty responses. The sender will trust this malicious response and update its ARP table. Lab 2 task 1.4</p>
<h3 id="icmp-attack">ICMP Attack</h3>
<h4 id="icmp-basics">ICMP Basics</h4>
<p>ICMP - Internet Control Message Protocol is used for network testing and debugging.<br>
Applications of ICMP: Ping &amp; Traceroute.</p>
<h4 id="icmp-vulnerability">ICMP Vulnerability</h4>
<h5 id="ping-of-death">Ping of Death</h5>
<p>Use IP fragmentation to exceed ICMP packet size limitation, reassembled packet can crash the system with buffer overflow.</p>
<h5 id="smurf-attack">Smurf Attack</h5>
<p>Smurf attack is a form of Distributed Denial of Service(DDoS) attack.<br>
Attacker send ICMP packets to the broadcast address of a network, using victim's IP as source (Spoofing). The nodes will send back replies to the victim which overwhelm the victim network.</p>
<h3 id="ip-vulnerabilies">IP Vulnerabilies</h3>
<ol>
<li>Unencrypted transmission - Eavesdropping is possible at any routing process</li>
<li>No source authentication - IP address can be spoofed, bad accountability</li>
<li>No integrity check - MITM Man in the middle attack can modify the content of packets</li>
<li>No bandwidth constraints - Large number of packets can be injected into a network, denial of service attack</li>
</ol>
<h3 id="denial-of-service-attack">Denial of Service Attack</h3>
<p>Attacker uses zombie network or botnet, to send large number of packets to service provider host and slow down or crash the host. Attacker can spoof the source of IP to hide themself.</p>
<h3 id="syn-flood">SYN Flood</h3>
<p>SYN is the TCP connection request, to which the receiver must response. SYN flood creates a large number of SYN requests with spoofed source IP address. The server responses with SYN/ACK but never gets a follow up. Eventually the service providing host stops accepting connection requests, thus triggering a denial of service.</p>
<h3 id="session-hijacking">Session Hijacking</h3>
<p>TCP session hijacking attempts to take control of TCP/IP sessions. The attacker has to guess the ack sequence number.</p>
<h3 id="ip-spoofing">IP Spoofing</h3>
<p>Send packets (with malicious intentions) from one IP address that is not the true origin IP.</p>
<h3 id="packet-sniffer">Packet Sniffer</h3>
<p>Packet sniffer intercepts network packets. This action needs root privilege as the sniffer requires access to network interface cards.<br>
Can be used as legitimate tools to analyze a network</p>
<ul>
<li>Monitor network usage</li>
<li>Filter network traffic</li>
<li>Analyze network problems</li>
</ul>
<p>Can also be used maliciously</p>
<ul>
<li>Steal information (i.e. passwords, conversations, etc.)</li>
<li>Analyze network information to prepare an attack</li>
</ul>
<h3 id="dns-attacks">DNS Attacks</h3>
<h4 id="dns-basics">DNS Basics</h4>
<p>DNS - Domain Name System is a application layer protocol for mapping domain names to IP addresses.</p>
<h4 id="dns-posioning">DNS Posioning</h4>
<p>Attacker feed DNS server false records and DNS server caches them.</p>
<h2 id="transport-layer-security--secure-socket-layer-tlsssl">Transport Layer Security / Secure Socket Layer (TLS/SSL)</h2>
<p><a href="#5-important-implementations">The 5 Important Implementations</a> can be applied to application layer. We can provide addtional transport layer security. TLS is evolved from SSL.<br>
These security measures can be adopted by client and server, with application security on top of them.</p>
<h2 id="virtual-private-network">Virtual Private Network</h2>
<p>Virtual Private Network - VPN allows users to create secure private network over a public network (the Internet). VPN server is required to connect outside computers to inside host. It also protects internal computers.</p>
<h3 id="ip-tunneling">IP Tunneling</h3>
<p>Tunnel transmits private network packets in the public network. The packets sent in tunnels encapsulates a IP packet, the inner IP packet is protected packets to/from private networks.</p>
<h4 id="ipsec-tunneling">IPSec Tunneling</h4>
<p>Utilizes the tunneling mode of Internet Protocol Security (IPSec) protocol. Encapsulate the private network IP packet in a new IP packet.</p>
<h4 id="tlsssl-tunneling">TLS/SSL Tunneling</h4>
<p>Tunneling done outside kernel at the application level. Encapsulate the private network IP packet in TCP/UDP payloads, then secure TCP/UDP packets with TLS/SSL protocol.</p>
<h1 id="symmetric-encryption">Symmetric Encryption</h1>
<p>Confidentiality can be reinforced with encrypion.</p>
<h2 id="terminologies">Terminologies</h2>
<ul>
<li>plaintext - original message</li>
<li>ciphertext – hidden/coded message</li>
<li>cipher (encryption)- algorithm for transforming plaintext to ciphertext</li>
<li>encipher (encrypt) - converting plaintext to ciphertext</li>
<li>decipher (decrypt) - recovering plaintext from ciphertext</li>
<li>key - info used in cipher known only to sender/receiver</li>
<li>cryptography - study of encryption principles/methods</li>
<li>cryptanalysis - deciphering the ciphertext without knowing the key</li>
</ul>
<h2 id="classic">Classic</h2>
<p>Based on either permutation or substitution.</p>
<h3 id="substitution">Substitution</h3>
<p>Letters of plaintext replaced by other letters.</p>
<h3 id="permutation">Permutation</h3>
<p>Change order of letters of plaintext.</p>
<h3 id="vulnerability">Vulnerability</h3>
<p>The classic cipher is susceptible to cryptanalysis like frequency analysis.</p>
<h2 id="mordern">Mordern</h2>
<p>Combination of permutation, substitution and more.</p>
<h3 id="advanced-encryption-standard">Advanced Encryption Standard</h3>
<p>AES - Advanced Encryption Standard is modern block cipher. Block cipher means AES works on fixed-length groups of bits called blocks.</p>
<h4 id="substitution-permutation-network">Substitution-Permutation Network</h4>
<p>S-P network is based on repetive substitution and permutation(transposition).</p>
<h4 id="specifications">Specifications</h4>
<p>Key length of AES can vary from 128/192/256 bits. Key regardless of size is used to generate 128-bits round key.<br>
Size of input block 128 bits = 128/8 = 16 Bytes = 16 ASCII Characters = 16 Two Digit Hexadecimal Numbers.<br>
The input is ordered in a 4 by 4 matrix, in a top-down, left to right order.</p>
<pre><code>Plaintext: A, B, C, ..., P
Input Block:
A E I M         41  45  49  4D                 
B F J N         42  46  4A  4E
C G K O         43  47  4B  4F
D H L P         44  48  4C  50
</code></pre>
<h4 id="aes-structure">AES Structure</h4>
<p>AES has multiple rounds, each round has following process:</p>
<ol>
<li>Byte substitution according to S-box. 1 Byte entry used on every byte.</li>
<li>Shift rows</li>
<li>Mix columns</li>
<li>Add(XOR) round key</li>
</ol>
<blockquote>
<p>These operations are <strong>SEQUENTIAL</strong>.</p>
</blockquote>
<p>The decryption process is the strict <strong>inverts</strong> of the encryption process.</p>
<h4 id="1-substitute-bytes">1. Substitute Bytes</h4>
<p>For each byte, which equals to 2 digit hexadecimal number, use the first digit (4 bytes) to find row index and second digit to locate column index.</p>
<h4 id="2-shift-rows">2. Shift Rows</h4>
<p>1st row unchanged<br>
2nd row 1 byte circular shift to left<br>
3nd row 2 byte circular shift to left<br>
4nd row 3 byte circular shift to left</p>
<h4 id="3-mix-columns">3. Mix Columns</h4>
<p>Mix column is achieved by multiplying result of shift rows with Mix Column Matrix.</p>
<pre><code>Matrix for Mix Column
02 03 01 01
01 02 03 01
01 01 02 03
03 01 01 02
</code></pre>
<h5 id="matrix-multiplication---multiply">Matrix Multiplication - Multiply</h5>
<p>Multiply by 01 - result remains same<br>
Multiply by 02 - in binary mult by 2 is equivalent to left by one. if most significant bit is 1 before shift, result must XOR 0x1B.<br>
Multiply by 03 - equals multiply by 02 then add input again</p>
<h5 id="matrix-multiplication---add">Matrix Multiplication - Add</h5>
<p>Addition is XOR</p>
<h4 id="4-xor-round-key">4. XOR Round Key</h4>
<p>XOR mix column result with round key. Round key generation is ingored for this course. Longer the original key, more rounds of encryption.</p>
<h3 id="mathematics-of-ase">Mathematics of ASE</h3>
<h4 id="xor-inverse-property">XOR Inverse Property</h4>
<p>Get cipher by XOR input with key. We can invert cipher back to plaintext by XOR cipher with key.</p>
<h4 id="set-and-field">Set and Field</h4>
<p>A set only consists of elements. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>8</mn></msub><mo>=</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>7</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">Z_8 = \{1,2,3,\dots, 7\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">7</span><span class="mclose">}</span></span></span></span><br>
Field is a set combined with addition and multiplication.</p>
<h4 id="identity">Identity</h4>
<h5 id="additive-identity">Additive Identity</h5>
<p>A number (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>) in the set which doesn't change the value of a given number when added to it.</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>+</mo><mn>0</mn><mo>=</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">a + 0 = a
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span></span></p>
<h5 id="multiplicative-identity">Multiplicative Identity</h5>
<p>A number (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>) in the set which doesn't change the value of a given number when multiplied to it.</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>×</mo><mn>1</mn><mo>=</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">a \times 1 = a
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span></span></p>
<h4 id="inverse">Inverse</h4>
<h5 id="additive-inverse">Additive Inverse</h5>
<p>A number (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">-a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord mathnormal">a</span></span></span></span>) in the set which produces <strong>additive identity value(0)</strong> when added to a given number.</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a + (-a) = 0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p>
<h5 id="multiplicative-inverse">Multiplicative Inverse</h5>
<p>A number (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext>a</mtext><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\text{a}^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord text"><span class="mord">a</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>) in the set which produces <strong>multiplicative identity value(1)</strong> when multiplied to a given number. An integer has a multiplicative inverse in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">Z_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> if that integer is relatively prime to n.</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>×</mo><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a \times a^{-1} = 1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p>
<h4 id="modulo-arithmetic">Modulo Arithmetic</h4>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>n</mi><mtext> </mtext><mo>=</mo><mtext> </mtext><mi>b</mi><mo separator="true">,</mo><mtext>  </mtext><mn>0</mn><mo>&lt;</mo><mo>=</mo><mi>b</mi><mo>&lt;</mo><mo>=</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a\ mod\ n\ =\ b,\ \  0&lt;=b&lt;=n-1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">a</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace"> </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>=</mo><mi>q</mi><mo>×</mo><mi>n</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a = q\times n + b
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></span></p>
<p>n modulus<br>
b residue</p>
<h4 id="finite-field">Finite Field</h4>
<p>A field is called a finite field if the set F is finite.<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>p</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">Z_p=\{0,1,2,\dots,p-1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span>, we define + and ⋅ as addition modulo p and multiplication modulo p</p>
<h4 id="galois-field">Galois Field</h4>
<p>For every prime power <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mi>n</mi></msup><mo separator="true">,</mo><mi>n</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">p^n, n = 1,2,\dots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span></span></span></span>, there is a unique finite field containing <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">p^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> elements, denoted by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>f</mi><mo stretchy="false">(</mo><msup><mi>p</mi><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">gf(p^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> or Galois Field.</p>
<h5 id="primitive-galois-field">Primitive Galois Field</h5>
<p>Primitive Galois Field is where n = 1, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>f</mi><mo stretchy="false">(</mo><msup><mi>p</mi><mn>1</mn></msup><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mi>f</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">gf(p^1) = gf(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span>, where arithmetic is done modulo p.<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>f</mi><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">gf(2) = \{0,1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span> add mult modulo 2<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>f</mi><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">gf(3) = \{0,1,2\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose">}</span></span></span></span> add mult modulo 2</p>
<h5 id="extension-galois-field">Extension Galois Field</h5>
<p>Extension Galois Field is Galois Field where n is greater than 1. AES uses <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>f</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>8</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">gf(2^8)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.<br>
Extension field uses polynomials as elements. An element from <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>f</mi><mo stretchy="false">(</mo><msup><mi>p</mi><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">gf(p^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> can be represented as polynomial <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>, with highest degree of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> and coefficiency in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>f</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">gf(p)=\{0,1,\dots,p-1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span>.<br>
modulo reduction (fixed irreducible polynomial as modulus) for multiplication, XOR for addition.</p>
<h6 id="special-galois-field-gf2n">Special Galois Field <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>f</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">gf(2^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></h6>
<p>The highest degree of n-1 and coefficiency in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{0,1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span>.<br>
E.g <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>f</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">gf(2^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> has four elements <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">}</mo><mo>=</mo><mo stretchy="false">{</mo><mn>00</mn><mo separator="true">,</mo><mn>01</mn><mo separator="true">,</mo><mn>10</mn><mo separator="true">,</mo><mn>11</mn><mo stretchy="false">}</mo><mo>=</mo><mrow><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><mi>x</mi><mo>+</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">\{0,1,2,3\}=\{00,01,10,11\}={0,1,x,x+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">00</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">01</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">11</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span></span></p>
<h6 id="addition">Addition</h6>
<p>Adding polynomials requires addition (XOR) of coefficiency.<br>
For <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>f</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">gf(2^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, coefficiency of polynomial element is either 0 or 1.</p>
<pre><code>In mod 2 addition
0+0=0
1+0=1
0+1=1
1+1=0
This is why we can use XOR to achieve mod 2 addition.
</code></pre>
<h6 id="modulo-reduction">Modulo Reduction</h6>
<p>The irreducible polynomial as modulus, calculate the residue.<br>
Calculate A(x) mod B(x), divide A(x) by B(x), use XOR as minus.</p>
<h1 id="asymmetric-encryption">Asymmetric Encryption</h1>
<p>Asymmetric encryption uses different keys for encryption and decryption. The public key cryptography complements symmetric cryptography. The public key can be shared without a secure channel.</p>
<h2 id="applications">Applications</h2>
<ol>
<li>Encryption and Decryption - Confidentiablity</li>
<li>Digital Signature - Authenticity</li>
<li>Key Exchange - Share session key in insecure channnel</li>
</ol>
<h2 id="rsa">RSA</h2>
<p>By Rivest, Shamir &amp; Adleman of MIT in 1977.<br>
RSA uses exponentiation of integers modulo a prime. Exponentiation is repeated multiplication.</p>
<h3 id="key-generation">Key Generation</h3>
<p>Step 1<br>
Select prime number p and q, p != q, which means p and q are also coprime.</p>
<p>Step 2<br>
Calculate <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mo>×</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">n = p \times q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><br>
Calculate <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)=(p-1)\times (q-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p>
<p>Step 3<br>
Select integer e, so that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>e</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">gcd(\phi(n),e)=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>&lt;</mo><mi>e</mi><mo>&lt;</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">1&lt;e&lt;\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p>
<blockquote>
<p>gcd(a,b) = 1 also means a and b are coprime</p>
</blockquote>
<p>Step 4
Calculate d, so that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>e</mi><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">de\ mod\ \phi(n) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></p>
<p>Step 5<br>
Public Key = {e, n}<br>
Private Key = {d, n}</p>
<h3 id="rsa-encryption-and-decryption">RSA Encryption and Decryption</h3>
<h4 id="encryption-with-public-key">Encryption with Public Key</h4>
<p>Plain text m &lt; n (smaller bit size for binary)<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><msup><mi>M</mi><mi>e</mi></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">C = M^e(mod\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p>
<h4 id="decryption-with-private-key">Decryption with Private Key</h4>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><msup><mi>C</mi><mi>d</mi></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">M = C^d(mod\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p>
<h3 id="mathematics-for-rsa">Mathematics for RSA</h3>
<h4 id="division">Division</h4>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mi>q</mi><mi>n</mi><mo>+</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">a = qn + r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mo>=</mo><mi>r</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">0&lt;=r&lt;n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span><br>
Divide a by n get quotient q and residual r.<br>
E.g.<br>
a = -4, n = 11, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><mi>n</mi><mo>+</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">a=(-1)\times n+7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">7</span></span></span></span>, residual 7</p>
<h4 id="euclids-algorithm---gcd">Euclid's Algorithm - GCD</h4>
<p>Euclid's |ˈjuːklɪd| Algorithm is the algorithm for finding the greatest common divisor of two numbers.<br>
m = n (q1)  + r1<br>
n  = r1 (q2) + r2<br>
r1 = r2 (q3) + r3<br>
r2 = r3 (q4) + r4<br>
...<br>
rn-3 = rn-2 (qn-1) + rn-1<br>
rn-2 = rn-1 (qn) + rn gcd<br>
rn-1 = rn (qn+1) + 0</p>
<h4 id="bizouts-identity">Bizout's Identity</h4>
<p>Bizout? Bézout? Extension of Euclid's Algorithm.<br>
For positive integer m and n, gcd(m, n) is the <strong>smallest</strong> <strong>positive</strong> element of the set</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">{</mo><mi>a</mi><mi>m</mi><mo>+</mo><mi>b</mi><mi>n</mi><mo>:</mo><mtext> </mtext><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mi>i</mi><mi>n</mi><mi>Z</mi><mo>=</mo><mo stretchy="false">{</mo><mo>…</mo><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mtext> </mtext><mo stretchy="false">}</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{am+bn:\ a,b in Z=\{\dots,-2,-1,0,1,2,\dots \}\}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">am</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">bn</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">bin</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mclose">}}</span></span></span></span></span></p>
<h4 id="application-of-euclid-and-bizout-in-rsa">Application of Euclid and Bizout in RSA</h4>
<p>We can usd Euclid's algorithm in reverse to get modulo inverse, the process of known e and calculate d.</p>
<blockquote>
<p>Recall:<br>
Multiplicative Identity - a number (1) in the set when multiplied to gets the same value as input.<br>
Multiplicative Inverse - a number in the set when multiplied to gets identity (1).<br>
The same rule for finding multiplicative inverse of a mod b, under mod b set.</p>
</blockquote>
<h4 id="euler-totient-function">Euler Totient Function</h4>
<p>Euler |ˈɔɪlə| Totient Function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> = The <strong>number of elements</strong> in reduced set of residues.
The result set of residues mod n is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{0,1,2,\dots,n-1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span>.<br>
The reduced set of residues is the subset of numbers in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{0,1,2,\dots,n-1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span> thats relatively prime to n.<br>
Special case:<br>
For p prime <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\phi(p)=p-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></p>
<blockquote>
<p>mod p residue set {0,1,2,...,p-1}, reduced residue set = {1,2,...,p-1}<br>
1 is coprime to any number, 0 is not coprime with any number</p>
</blockquote>
<p>And for p, q both prime, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>p</mi><mo>×</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(p\times q) = (p-1)(q-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p>
<blockquote>
<p>RSA choose non-equal prime p and q, to exploit this property.</p>
</blockquote>
<h4 id="fermats-little-theorem">Fermat's Little Theorem</h4>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>a</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mtext> </mtext><mo>=</mo><mtext> </mtext><mn>1</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^{p-1}\ =\ 1(mod\ p)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p>
<blockquote>
<p>(mod p) means modulo p on <strong>both sides</strong> of the equation.</p>
</blockquote>
<p>Where p is prime and gcd(a,p)=1, a and p are coprime.</p>
<h4 id="eulers-theorem">Euler's Theorem</h4>
<p>Euler's Theorem is generaization of Fermat's Little Theorem.</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>a</mi><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mtext> </mtext><mo>=</mo><mtext> </mtext><mn>1</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^{\phi(n)}\ =\ 1(mod\ n)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.938em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϕ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p>
<p>For <strong>any</strong> a and n where gcd(a,n)=1, a and n are coprime.</p>
<h4 id="implement-theorem-in-rsa">Implement Theorem in RSA</h4>
<p>Given <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>e</mi><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">de\ mod\ \phi(n)=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> we get <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>e</mi><mo>=</mo><mi>k</mi><mo>×</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">de = k\times\phi(n)+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><br>
and Euler's theorem <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mtext> </mtext><mo>=</mo><mtext> </mtext><mn>1</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^{\phi(n)}\ =\ 1(mod\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϕ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> for coprime a and n.</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>C</mi><mi>d</mi></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>M</mi><mi>e</mi></msup><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mo>=</mo><msup><mi>M</mi><mrow><mi>e</mi><mi>d</mi></mrow></msup><mo>=</mo><msup><mi>M</mi><mrow><mi>k</mi><mo>×</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>M</mi><mo>×</mo><mo stretchy="false">(</mo><msup><mi>M</mi><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mi>k</mi></msup><mo>=</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">C^d = (M^e)^d = M^{ed} = M^{k\times\phi(n)+1} = M\times (M^{\phi(n)})^k = M
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.938em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">ϕ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϕ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></p>
<h1 id="final-review">Final Review</h1>
<p>Majority in class exercise</p>
<h2 id="ice4-rsa-part">ICE4 RSA part:</h2>
<ol>
<li>Euler’s totient function</li>
<li>Euclidean algorithm, get gcd</li>
<li>Bizout's algorithm top down<br>
use the relationship in Euclidean algorithm's steps, bottom up<br>
other possible questions: the modification? multiplicative inverse of some number</li>
<li>RSA key gen, encrypt &amp; decrypt</li>
<li>restriction of input smaller than n</li>
</ol>
<h2 id="ice3-aes-part">ICE3 AES part:</h2>
<ol>
<li>Special case multiply by 2, left shift, if most significant bit is 1, XOR with 0x1B</li>
<li>Polynomial multiplication</li>
</ol>
<blockquote>
<p>Double check result with alternative shift and xor method</p>
</blockquote>
<ol>
<li>AES Tranformation - sequential operation, use result from previous transformation as input</li>
</ol>
<blockquote>
<p>mult 0x02 left shift, mult 0x03 = mult 0x02 &amp; XOR orignal<br>
special case XOR 0x1B</p>
</blockquote>
<h2 id="ice2-network-security">ICE2 Network Security</h2>
<p>Understand slides &amp; lab then solve question
Understand attacks</p>
<ol>
<li>Packages are visible in LAN from lab experience</li>
<li>Elaborate step to step how to carry out the attack</li>
<li>Application Level user control (symmetric &amp; asymmetric), end to end, safe from all other parties</li>
<li>Infrastructure Level, router to router, example intercontiental companies communication between headquarters</li>
</ol>
<h2 id="ice1-symmetric--asymmetric-cryptosystem">ICE1 Symmetric &amp; Asymmetric Cryptosystem</h2>
<ol>
<li>Confidentiality</li>
<li>Authentication</li>
<li>Certificate</li>
</ol>

        <script async src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </body>
    </html>